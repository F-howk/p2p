$(function(){function o(){var e=localStorage.getItem("id");$.get("http://127.0.0.1:3333/getuserinfo.php",{id:e},function(e){var t,a,o,l;for(var n in e=JSON.parse(e),t=e.totalmoney,a=e.usablemoney,o=e.blockedmoney,l=echarts.init(document.getElementById("pie")),option={title:{text:"资金分布",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{left:"center",top:"bottom",data:["总金额","可用金额","冻结金额"]},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["pie","funnel"]},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"半径模式",type:"pie",radius:[20,110],center:["50%","50%"],roseType:"radius",label:{show:!1},emphasis:{label:{show:!0}},data:[{value:t,name:"总金额"},{value:a,name:"可用金额"},{value:o,name:"冻结金额"}]}]},l.setOption(option),e)$("."+n).html(e[n]);localStorage.setItem("allmoney",e.totalmoney)})}o(),$("#myModal .save").on("click",function(){var e=localStorage.getItem("id"),t=$("#nickname").val().trim(),a=$("#email").val().trim();""!=t&&""!=a?$.get("http://127.0.0.1:3333/updateuser.php",{id:e,nickname:t,email:a},function(e){console.log(e),"ok"==e?($("#myModal").modal("hide"),o()):alert("更新失败!")}):alert("更新失败!")})});